#!/bin/sh

BASE=/u/g/release/Source
SRC=${BASE}/src/tools/disp
SPEC=${BASE}/src/lib/tdf/def_4_1.db

make_mf\
    +A BASE=${BASE}\
    +A SRC=${SRC}\
    +A SRC1=${SRC}/templ\
    +A SPEC=${SPEC}\
    +W ...\
    +V 'EXTRA=auto'\
    -o .../disp\
    -Yansi -Xs\
    ${SRC}/*.c\
    > Makefile

cat >> Makefile << EOF

MAKE_TDF=make_tdf
SED=sed

auto : \${SRC}/tdf.c \${SRC}/tdf.h

\${SRC}/tdf.c : \${SPEC} \${SRC1}/tdf.c \${SRC1}/tdf.sed
	@\${REMOVE} \${SRC}/tdf.c
	\${MAKE_TDF} \${SPEC} \${SRC1}/tdf.c | \${SED} -f \${SRC1}/tdf.sed > \${SRC}/tdf.c

\${SRC}/tdf.h : \${SPEC} \${SRC1}/tdf.h
	@\${REMOVE} \${SRC}/tdf.h
	\${MAKE_TDF} \${SPEC} \${SRC1}/tdf.h \${SRC}/tdf.h

auto_clobber :
	\${REMOVE} \${SRC}/tdf.c \${SRC}/tdf.h
EOF
